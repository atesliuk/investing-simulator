<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="#">Home</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{thePortfolio.name}}</li>
  </ol>
</nav>

<div class="container">
  <div class="row">
    <div class="col-8">
      <nav class="navbar navbar-dark bg-dark">
        <span *ngIf="thePortfolio.name!=''" class="navbar-brand mb-0 h1">{{thePortfolio.name}} | current value: {{thePortfolio.current_portfolio_value}}
          | Cash: {{thePortfolio.cash}} | Returns: {{(thePortfolio.current_portfolio_value/thePortfolio.initialInvestment - 1)*100}}%</span>
      </nav>

      <br>

      <div
        class="alert {{alertType}} alert-dismissible collapse {{alertShowFade}}"
        role="alert">
        {{alertText}}
        <button type="button" class="close" aria-label="Close" (click)="alertShowFade='fade'">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <br>
      <h6> *Here will be graph* </h6>
      <br>

      <ul *ngIf="openDeals.length>0" class="list-group">
        <li class="list-group-item active">Assets</li>
        <div *ngFor="let deal of this.openDeals.values()">
          <li class="list-group-item"> {{deal.stockSymbol}} x {{deal.amount}}
            <button type="button" class="btn btn-danger" (click)="this.selectedDeal=deal" data-toggle="modal"
                    data-target="#sellStockModal">SELL
            </button>
          </li>
        </div>
      </ul>
      <ul *ngIf="openDeals.length==0" class="list-group">
        <li class="list-group-item active">Assets</li>
        <li class="list-group-item"> No bought stocks yet</li>
      </ul>

      <br>

      <ul class="list-group">
        <ul *ngIf="closedDeals.length>0" class="list-group">
          <li class="list-group-item active">Closed deals</li>
          <div *ngFor="let deal of this.closedDeals.values()">
            <li class="list-group-item"> {{deal.stockSymbol}} x {{deal.amount}} | opened: {{deal.openDate}} | closed: {{deal.closingDate}}
              | bought @ {{deal.openPrice}} | sold @ {{deal.closingPrice}} | profit: {{deal.amount * (deal.closingPrice - deal.openPrice)}}
            </li>
          </div>
        </ul>
        <ul *ngIf="closedDeals.length==0" class="list-group">
          <li class="list-group-item active">Closed deals</li>
            <li class="list-group-item"> No closed deals yet</li>
        </ul>
      </ul>

    </div>
    <div class="col-4">
      <app-all-stocks-list
        (buyStockEvent)="buyStockEventHandler($event)"
        (getAllStocksEvent)="getAllStocks($event)"
        [thePortfolio]="thePortfolio"
      ></app-all-stocks-list>
    </div>
  </div>
</div>

<!-- Sell Stock Modal -->
<div *ngIf="selectedDeal.stockSymbol!='' && allStocks.size>0" class="modal fade" id="sellStockModal" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalLabel"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel2">Sell {{this.selectedDeal.stockSymbol}} stocks?</h5>
        <button type="button" class="close" data-dismiss="modal" id="closeModal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>You have {{selectedDeal.amount}} {{selectedDeal.stockSymbol}} stock(s). </p>
        <p>Do you want to sell them for ${{allStocks.get(selectedDeal.stockSymbol).price}} each?</p>
        <p>Profit: {{selectedDeal.amount * (allStocks.get(selectedDeal.stockSymbol).price - selectedDeal.openPrice)}}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" (click)="sellStock(selectedDeal)">SELL</button>
      </div>
    </div>
  </div>
</div>

